---
title: 计算与仿真
icon: 'laptop-code'
category:
  - Computer
  - basic
---

## 简述

在这个文章当中都是有关计算与仿真相关笔记。如有错误还请帮忙指正！

## 机器数(Machine Number)

见[这里](./README.md#机器数machine-number)

## 缩小舍入误差

### 1.误差的来源

1. 截断误差(truncation error): 当我们使用一个有限数列去拟合一个无限数列时，就会出现截断误差。举个例：

    有以下无限数列: $\exp ^x = 1 + {x \over 1!} + {x^2 \over 2!} + \dots$

    当我们使用有限数列: $P_3 (x) = 1 + x + {x^2 \over 2!} + {x^3 \over 3!}$进行拟合时，

    则会出现截断误差: $R_3 (x) = \exp ^x - P_3 (x)$

    具体可以看[泰勒理论](./compute_and_simutation.md#泰勒理论)

2. 舍入误差(round-off error): 当我们尝试将一个非机器数存入计算机时，由于计算机自身精度有限，因此会有舍入误差。

3. 数据误差(data error): 所有的真实数据都存在测量误差，在此称其为测量误差。

4. 模型误差(model error): 所有的数学模型都是针对物理现象的拟合，由此会出现模型误差。

5. 操作员误差(blunders): 由于计算机操作员人工输入数据导致的误差。

6. 传播误差(propagated error): 数值方法是迭代的，这意味着第 i 步的解取决于第 i-1 步的解。因此，第 i 步的误差取决于第 i-1 步的误差。随着方法的迭代，传播的误差会越来越大。如果计算出的解越来越大，掩盖了真正的解，那么它就变得毫无意义，我们就会说这种方法不稳定。

---

### 2.霍纳法则(秦九韶算法)

一般地，一元n次多项式的求值需要经过 $(n+1)*n \over 2$次乘法和 `n` 次加法，而秦九韶算法只需要 `n` 次乘法和 `n` 次加法。在人工计算时，一次大大简化了运算过程。

把一个n次多项式 $f(x) = a_nx^n + a_{n-1}x^{n-1} + \dots + a_1x^1 + a_0$
改写成如下形式：

$$f(x)$$

$$= (a_nx^{n-1} + a_{n-1}x^{n-2} + \dots + a_2x^1 + a_1)x + a_0$$

$$= ((a_nx^{n-2} + a_{n-1}x^{n-3} + \dots + a_2)x + a_1)x + a_0$$

$$\vdots$$

$$= ( \dots ((a_nx + a_{n-1})x + a_{n-2})x + \dots + a_1)x + a_0$$

求多项式的值时，首先计算最内层括号内一次多项式的值，即

$$v_1 = a_nx + a_{n-1}$$

然后由内向外逐层计算一次多项式的值，即

$$v_2 = v_1x + a_{n-2}$$

$$v_3 = v_2x + a_{n-3}$$

$$\vdots$$

$$v_n = v_{n-1}x + a_{0}$$

这样，求n次多项式f(x)的值就转化为求n个一次多项式的值。

结论：**对于一个n次多项式，至多做n次乘法和n次加法。**

---

### 3.使用泰勒展开拟合任意函数

对于可以在任意点进行充分多次求导的函数 f(x) 而言，关于其展开点 (a, f(a)) 的泰勒展开式为：

$$f(x) = f(a) + f'(a)(x-a) + {f''(a) \over 2!}(x - a)^2 + {f''(a) \over 3!}(x - a)^3 + \dots$$

$$= \sum_{k=0}^{\infin} {f^{(k)}(a) \over k!}(x - a)^k$$

则我们可以不通过知道函数本身，而只要知道任意点的值以及该值的导数 $(a,f(a))$，就可以通过该公式对该函数进行拟合。

:::info
麦克劳林数列是泰勒数列的一种特殊情况。当一个可以在任意点进行充分多次求导的函数 f(x) 使用泰勒展开进行拟合时取 `a = 0`，即 $(0,f(0))$ 进行展开操作，则展开后的数列被称为麦克劳林数列。他一般被写为如下形式：

$$f(x) = f(0) + f'(0)x + {f''(0) \over 2!}x^2 + {f''(0) \over 3!}x^3 + \dots$$

$$= \sum_{k=0}^{\infin} {f^{(k)}(0) \over k!}x^k$$
:::

## 泰勒理论

**如果函数 f(x) 在包含 a 和 x 的区间上具有 1、2、...、(n + 1) 阶导数，则 f(x) 的值可以表示为：f(x) = (n + 1) 项截断的泰勒级数的总和 + 余项 Rn 。** 用公式可记为：

$$f(x) = \sum_{k=0}^{n}{f^{(k)}(a) \over k!}(x - a)^{k} + R_n$$

而余项我们一般称其为 **截断误差(truncation error)**。用公式表示为：

$$R_n = {f^{(n + 1)}(c) \over (n + 1)!}(x - a)^{n + 1} \space \text{where {\it c} is between a and x}$$
